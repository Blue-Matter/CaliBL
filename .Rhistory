library(openMSE)
library(r4ss)
library(abind)
setwd("C:/Users/tcarruth/Documents/GitHub/CDFW_Bag_Limits")
OM = readRDS("./OMs/OM.rdata")
OM = SubCpars(OM,sims=1:64)
MPCR<-readRDS("./OMs/MPCR.rda")
ncr=nrow(MPCR)
Data=new('Data')
Data@VInd = Data@CV_VInd = array(NA,c(1,OM@nyears))
Data@VInd[1,OM@nyears-(ncr-1):0]=MPCR$x
Data@CV_VInd[] = 0.1
OM@cpars$Data = Data
save(OM,file="C:/Users/tcarruth/Documents/GitHub/CaliBL/data/DemoOM.RData")
devtools::install_github('blue-matter/CaliBL)
devtools::install_github('blue-matter/CaliBL')
devtools::install_github('blue-matter/CaliBL')
devtools::install_github('blue-matter/CaliBL')
library(CaliBL)
devtools::install_github('blue-matter/CaliBL')
devtools::install_github('blue-matter/CaliBL')
githubdir = "C:/Users/tcarruth/Documents/Github/"
frompath = paste0(githubdir,"CDFW_Bag_Limits")
frompathG = "G:/Shared drives/BM shared/1. Projects/CDFW_halibut_bag_limits"
topath = paste0(githubdir,"CaliBL/docs")
file.copy(paste0(frompathG,"/Status Assumptions To Do.xlsx"),paste0(topath,"/Project_Info/Status Assumptions To Do.xlsx"),overwrite=T)
library(DT)
?datatable
setwd("C:/Users/tcarruth/Documents/Github/CaliBL/docs)
setwd("C:/Users/tcarruth/Documents/Github/CaliBL/docs")
page="Deliverables"
tab=as.data.frame(read_excel("Project_Info/Status Assumptions To do.xlsx", sheet = page))
library(dplyr)
library(kableExtra)
library(readxl)
library(DT)
tab=as.data.frame(read_excel("Project_Info/Status Assumptions To do.xlsx", sheet = page))
setwd("C:/Users/tcarruth/Documents/Github/CaliBL/docs")
tab=as.data.frame(read_excel("Project_Info/Status Assumptions To do.xlsx", sheet = page))
page="Status"
tab=as.data.frame(read_excel("Project_Info/Status Assumptions To do.xlsx", sheet = page))
tab[is.na(tab)]=""
tab
dt<-datatable(tab,caption=NULL,container=sketch,
extensions = 'Buttons',options=list(dom = 'Bt',pageLength=100,
buttons = c('csv', 'excel')),height = "100%" )  #%>%
dt<-datatable(Tab,caption=NULL,
extensions = 'Buttons',options=list(dom = 'Bt',pageLength=100,
buttons = c('csv', 'excel')),height = "100%" )  #%>%
dt<-datatable(tab,caption=NULL,extensions = 'Buttons',options=list(dom = 'Bt',pageLength=100,
buttons = c('csv', 'excel')),height = "100%" )  #%>%
dt
nbk <- 100
j = ncol(tab)
brks <- seq(min(Tab[,j]),max(Tab[,j]),length.out=nbk)
nbk <- 100
j = ncol(tab)
# Create breaks for shading column values high to low
brks <- seq(min(tab[,j]),max(tab[,j]),length.out=nbk)
brks
nbk <- 100
j = ncol(tab)
brks <- seq(min(tab[,j]),max(tab[,j]),length.out=nbk)
y <- round(seq(255, 40, length.out = nbk + 1), 0)
clrs <- paste0("rgb(", y, ", 255,", y, ")")
clrs <- rainbow(nbk + 1, start=0.05,end=0.3,)
dt <- DT::formatStyle(dt, j, backgroundColor = DT::styleInterval(brks, clrs))
dt
nbk <- 100
j = ncol(tab)
brks <- seq(min(tab[,j]),max(tab[,j]),length.out=nbk)
y <- round(seq(255, 40, length.out = nbk + 1), 0)
clrs <- rainbow(nbk + 1, start=0.05,end=0.3)
dt <- DT::formatStyle(dt, j, backgroundColor = DT::styleInterval(brks, clrs))
dt<-datatable(tab,caption=NULL,extensions = 'Buttons',options=list(dom = 'Bt',pageLength=100),height = "100%" )  #%>%
nbk <- 100
j = ncol(tab)
brks <- seq(min(tab[,j]),max(tab[,j]),length.out=nbk)
y <- round(seq(255, 40, length.out = nbk + 1), 0)
clrs <- rainbow(nbk + 1, start=0.05,end=0.3)
dt <- DT::formatStyle(dt, j, backgroundColor = DT::styleInterval(brks, clrs))
dt
?datatable
dt<-datatable(tab,caption=NULL,extensions = 'Buttons',height = "100%",rownames = F )  #%>%
dt
dt<-datatable(tab,caption=NULL,height = "100%",rownames = F )  #%>%
dt<-datatable(tab,caption=NULL,options(dom='t',height = "100%",rownames = F )
nbk <- 100
dt<-datatable(tab,caption=NULL,options(dom='t',height = "100%",rownames = F )
nbk <- 100
dt<-datatable(tab,caption=NULL,options(dom='t'),height = "100%",rownames = F )
nbk <- 100
j = ncol(tab)
brks <- seq(min(tab[,j]),max(tab[,j]),length.out=nbk)
y <- round(seq(255, 40, length.out = nbk + 1), 0)
clrs <- rainbow(nbk + 1, start=0.05,end=0.3)
dt <- DT::formatStyle(dt, j, backgroundColor = DT::styleInterval(brks, clrs))
dt<-datatable(tab,caption=NULL,height = "100%",rownames = F )
nbk <- 100
j = ncol(tab)
brks <- seq(min(tab[,j]),max(tab[,j]),length.out=nbk)
y <- round(seq(255, 40, length.out = nbk + 1), 0)
clrs <- rainbow(nbk + 1, start=0.05,end=0.3)
dt <- DT::formatStyle(dt, j, backgroundColor = DT::styleInterval(brks, clrs))
dt<-datatable(tab,caption=NULL,options(dom='t'),height = "100%",rownames = F )
nbk <- 100
j = ncol(tab)
brks <- seq(min(tab[,j]),max(tab[,j]),length.out=nbk)
y <- round(seq(255, 40, length.out = nbk + 1), 0)
clrs <- rainbow(nbk + 1, start=0.05,end=0.3)
dt <- DT::formatStyle(dt, j, backgroundColor = DT::styleInterval(brks, clrs))
dt
library(dplyr)
library(kableExtra)
library(readxl)
library(DT)
setwd("C:/Users/tcarruth/Documents/Github/CaliBL/docs")
page="Status"
getprojectinfo<-function(page,addcol=F){
tab=as.data.frame(read_excel("Project_Info/Status Assumptions To do.xlsx", sheet = page))
tab[is.na(tab)]=""
dt<-datatable(tab,caption=NULL,options(dom='t'),height = "100%",rownames = F )
nbk <- 100
j = ncol(tab)
brks <- seq(min(tab[,j]),max(tab[,j]),length.out=nbk)
y <- round(seq(255, 40, length.out = nbk + 1), 0)
clrs <- rainbow(nbk + 1, start=0.05,end=0.3)
if(addcol)dt <- DT::formatStyle(dt, j, backgroundColor = DT::styleInterval(brks, clrs))
dt
}
getprojectinfo(page)
getprojectinfo(page,T)
setwd("C:/Users/tcarruth/Documents/Github/CaliBL/docs")
page="Status"
getprojectinfo<-function(page,addcol=F){
tab=as.data.frame(read_excel("Project_Info/Status Assumptions To do.xlsx", sheet = page))
tab[is.na(tab)]=""
dt<-datatable(tab,caption=NULL,options(dom='t'),height = "100%",rownames = F )
nbk <- 100
j = ncol(tab)
brks <- seq(min(tab[,j]),max(tab[,j]),length.out=nbk)
y <- round(seq(255, 40, length.out = nbk + 1), 0)
clrs <- rainbow(nbk + 1, start=0.05,end=0.3)
if(addcol)dt <- DT::formatStyle(dt, j, backgroundColor = DT::styleInterval(brks, clrs))
dt
}
getprojectinfo(page,T)
getprojectinfo("Status",T)
getprojectinfo("Status",T)
getprojectinfo("Status",T)
getprojectinfo("Status",F)
getprojectinfo("Tasks",T)
getprojectinfo("Tasks",F)
# setwd("C:/Users/tcarruth/Documents/GitHub/CDFW_Bag_Limits")
source("Code/Source.r")
source("../../CaliBL/R/Source.r")
BagLim = 3
V_pois = 0.5
V_ln1 = 0.5 ; CV_ln1 = 0.4
V1_ln2 = 0.2 ; V2_ln2 = 0.5 ; CV_ln2 = 0.4
CV_VM1 = 0.8 ; Vslp1 = 0.5 / max(obsCR)
source("../../CaliBL/R/Source.r")
# - 2 - Load Data -------------------------------------------------------------------------
dat0 = read.csv("Data/Halibut_2022/CalHalRecFIN_nonconf.csv")
# setwd("C:/Users/tcarruth/Documents/GitHub/CDFW_Bag_Limits")
dat0 = read.csv("Data/Halibut_2022/CalHalRecFIN_nonconf.csv")
setwd("C:/Users/tcarruth/Documents/GitHub/CDFW_Bag_Limits")
dat0 = read.csv("Data/Halibut_2022/CalHalRecFIN_nonconf.csv")
dat = dat0[dat0$SPECIES_NAME == "CALIFORNIA HALIBUT",]
NA_tab=data.frame(Field = names(dat),All_NA = sapply(X=1:ncol(dat),function(X,dat){all(is.na(dat[,X]))},dat=dat))
kept = dat$NUMBER_KEPT_OBSERVED+dat$NUMBER_KEPT_UNOBSERVED
rel = dat$NUMBER_RELEASED_ALIVE
drel = dat$NUMBER_RELEASED_DEAD
No = dat$NUMBER_OF_ANGLERS
cpue = dat$ANGLER_CPUE
catch = dat$TOTAL_CATCH
yr = dat$RECFIN_YEAR
qt = floor(dat$RECFIN_MONTH / 6.1) + 1
tt = paste(yr,qt,sep="_")
isHtarg = dat$PRIMARY_TARGET_SPECIES_NAME == "California halibut"
n = aggregate(rep(1,nrow(dat)),by=list(tt),sum)
keep = n$x>500
obsCR = aggregate(cpue,by=list(tt),mean)[keep,]$x
muRelRate = aggregate((rel+drel)/catch, by=list(tt),mean)[keep,]
muT = aggregate(isHtarg,by=list(tt),mean)[keep,]
muNo = aggregate(No,by=list(tt),mean)[keep,]
obsRR = muRelRate$x
YS = muRelRate$Group.1
MPCR = aggregate(cpue,by=list(yr),mean)
saveRDS(MPCR,file="./OMs/MPCR.rda") # for designing MPs and calibrating stuff
BagLim = 3
V_pois = 0.5
V_ln1 = 0.5 ; CV_ln1 = 0.4
V1_ln2 = 0.2 ; V2_ln2 = 0.5 ; CV_ln2 = 0.4
CV_VM1 = 0.8 ; Vslp1 = 0.5 / max(obsCR)
CV_VM2 = 0.4 ; Vint = 0.35 ; Vslp2 = 0.075 # (0.55 - Vint) / max(obsCR)
CRvec = seq(min(obsCR)*0.5,max(obsCR)*2,length.out=100)
pRR_pois = pois_RR(CRvec, BagLim, V_pois)
pRR_ln1 = lnorm1_RR(CRvec, BagLim, CV_ln1, V_ln1)
pRR_ln2 = lnorm2_RR(CRvec, BagLim, CV_ln2, V1_ln2, V2_ln2)
pRR_VM1 = lnormVM1_RR(CRvec, BagLim, CV_VM1, Vslp1)
pRR_VM2 = lnormVM2_RR(CRvec, BagLim, CV_VM2, Vint, Vslp2)
xlim=c(1.3,3.1) # range(muCR$x)+c(-0.1,0.1)
par(mai=c(1,1,0,0))
plot(obsCR,obsRR,pch=19,col="black",xlim=xlim,ylim=range(obsRR),xlab="Mean Catch Rate",ylab="Proportion Released")
grid()
abline(v=3,lty=2,col="#99999980",lwd=3)
text(obsCR+0.08,obsRR,YS,cex=0.6)
lines(CRvec,pRR_ln1,pch=19,col="red",lwd=2)
legend('topleft',legend=c(paste0("Observed (BL = ",BagLim,")"),
paste0("LN 2par (Vol. RR = ",V_ln1,"  LNCV = ",CV_ln1),
paste0("LN 3par (Vol. RR 1fish = ",V1_ln2,"  Vol. RR BL = ",V2_ln2,"  LNCV = ",CV_ln2),
paste0("LN 2par (Vol. RR slp = ",Vslp1," LNCV = ",CV_VM1),
paste0("LN 3par (Vol. RR slp = ",Vslp2,"  Vol. RR int = ",Vint,"  LNCV = ",CV_VM2),
paste0("Poisson 1par (Vol. RR = ",V_pois,")")
),
cex=0.75,text.col=c("black",'red',"blue","green","orange","grey"),bty="n")
lines(CRvec,pRR_ln2,pch=19,col="blue",lwd=2)
lines(CRvec,pRR_VM1,pch=19,col="green",lwd=2)
lines(CRvec,pRR_VM2,pch=19,col="orange",lwd=2)
lines(CRvec,pRR_pois,pch=19,col="grey",lwd=2)
jpeg("./Figures/RRfits.jpeg",width=6,height=6,res=600,units='in')
BagLim = 3
V_pois = 0.5
V_ln1 = 0.5 ; CV_ln1 = 0.4
V1_ln2 = 0.2 ; V2_ln2 = 0.5 ; CV_ln2 = 0.4
CV_VM1 = 0.8 ; Vslp1 = 0.5 / max(obsCR)
CV_VM2 = 0.4 ; Vint = 0.35 ; Vslp2 = 0.075 # (0.55 - Vint) / max(obsCR)
CRvec = seq(min(obsCR)*0.5,max(obsCR)*2,length.out=100)
pRR_pois = pois_RR(CRvec, BagLim, V_pois)
pRR_ln1 = lnorm1_RR(CRvec, BagLim, CV_ln1, V_ln1)
pRR_ln2 = lnorm2_RR(CRvec, BagLim, CV_ln2, V1_ln2, V2_ln2)
pRR_VM1 = lnormVM1_RR(CRvec, BagLim, CV_VM1, Vslp1)
pRR_VM2 = lnormVM2_RR(CRvec, BagLim, CV_VM2, Vint, Vslp2)
xlim=c(1.3,3.1) # range(muCR$x)+c(-0.1,0.1)
par(mai=c(1,1,0,0))
plot(obsCR,obsRR,pch=19,col="black",xlim=xlim,ylim=range(obsRR),xlab="Mean Catch Rate",ylab="Proportion Released")
grid()
abline(v=3,lty=2,col="#99999980",lwd=3)
text(obsCR+0.08,obsRR,YS,cex=0.6)
lines(CRvec,pRR_ln1,pch=19,col="red",lwd=2)
legend('topleft',legend=c(paste0("Observed (BL = ",BagLim,")"),
paste0("L2P1 (Vol. RR = ",V_ln1,"  LNCV = ",CV_ln1),
paste0("L3P1 (Vol. RR 1fish = ",V1_ln2,"  Vol. RR BL = ",V2_ln2,"  LNCV = ",CV_ln2),
paste0("L2P2 (Vol. RR slp = ",Vslp1," LNCV = ",CV_VM1),
paste0("L3P2 (Vol. RR slp = ",Vslp2,"  Vol. RR int = ",Vint,"  LNCV = ",CV_VM2),
paste0("Poisson (Vol. RR = ",V_pois,")")
),
cex=0.75,text.col=c("black",'red',"blue","green","orange","grey"),bty="n")
lines(CRvec,pRR_ln2,pch=19,col="blue",lwd=2)
lines(CRvec,pRR_VM1,pch=19,col="green",lwd=2)
lines(CRvec,pRR_VM2,pch=19,col="orange",lwd=2)
lines(CRvec,pRR_pois,pch=19,col="grey",lwd=2)
dev.off()
githubdir = "C:/Github/"
githubdir = "C:/Users/tcarruth/Documents/Github/"
frompath = paste0(githubdir,"CDFW_Bag_Limits")
frompathG = "G:/Shared drives/BM shared/1. Projects/CDFW_halibut_bag_limits"
topath = paste0(githubdir,"CaliBL/docs")
copyall = function(thisdir, todir){
fromfiles = list.files(thisdir,include.dirs = F)
for(j in 1:length(fromfiles))  file.copy(paste0(thisdir,fromfiles[j]), paste0(todir,fromfiles[j]),overwrite=T)
}
copyall(thisdir=paste0(frompath,"/Figures/Data/"),todir= paste0(topath,"/Figures/"))
jpeg("./Figures/RRfits.jpeg",width=6,height=6,res=600,units='in')
BagLim = 3
V_pois = 0.5
V_ln1 = 0.5 ; CV_ln1 = 0.4
V1_ln2 = 0.2 ; V2_ln2 = 0.5 ; CV_ln2 = 0.4
CV_VM1 = 0.8 ; Vslp1 = 0.5 / max(obsCR)
CV_VM2 = 0.4 ; Vint = 0.35 ; Vslp2 = 0.075 # (0.55 - Vint) / max(obsCR)
CRvec = seq(min(obsCR)*0.5,max(obsCR)*2,length.out=100)
pRR_pois = pois_RR(CRvec, BagLim, V_pois)
pRR_ln1 = lnorm1_RR(CRvec, BagLim, CV_ln1, V_ln1)
pRR_ln2 = lnorm2_RR(CRvec, BagLim, CV_ln2, V1_ln2, V2_ln2)
pRR_VM1 = lnormVM1_RR(CRvec, BagLim, CV_VM1, Vslp1)
pRR_VM2 = lnormVM2_RR(CRvec, BagLim, CV_VM2, Vint, Vslp2)
xlim=c(1.3,3.1) # range(muCR$x)+c(-0.1,0.1)
par(mai=c(1,1,0,0))
plot(obsCR,obsRR,pch=19,col="black",xlim=xlim,ylim=range(obsRR),xlab="Observed Mean Catch Rate",ylab="Observed Proportion Released")
grid()
abline(v=3,lty=2,col="#99999980",lwd=3)
text(obsCR+0.08,obsRR,YS,cex=0.6)
lines(CRvec,pRR_ln1,pch=19,col="red",lwd=2)
legend('topleft',legend=c(paste0("Observed (BL = ",BagLim,")"),
paste0("L2P1 (Vol. RR = ",V_ln1,"  LNCV = ",CV_ln1),
paste0("L3P1 (Vol. RR 1fish = ",V1_ln2,"  Vol. RR BL = ",V2_ln2,"  LNCV = ",CV_ln2),
paste0("L2P2 (Vol. RR slp = ",Vslp1," LNCV = ",CV_VM1),
paste0("L3P2 (Vol. RR slp = ",Vslp2,"  Vol. RR int = ",Vint,"  LNCV = ",CV_VM2),
paste0("Poisson (Vol. RR = ",V_pois,")")
),
cex=0.75,text.col=c("black",'red',"blue","green","orange","grey"),bty="n")
lines(CRvec,pRR_ln2,pch=19,col="blue",lwd=2)
lines(CRvec,pRR_VM1,pch=19,col="green",lwd=2)
lines(CRvec,pRR_VM2,pch=19,col="orange",lwd=2)
lines(CRvec,pRR_pois,pch=19,col="grey",lwd=2)
dev.off()
copyall(thisdir=paste0(frompath,"/Figures/Data/"),todir= paste0(topath,"/Figures/"))
# setwd("C:/Users/tcarruth/Documents/GitHub/CDFW_Bag_Limits")
jpeg("./Figures/RRfits.jpeg",width=6,height=6,res=600,units='in')
BagLim = 3
V_pois = 0.5
V_ln1 = 0.5 ; CV_ln1 = 0.4
V1_ln2 = 0.2 ; V2_ln2 = 0.5 ; CV_ln2 = 0.4
CV_VM1 = 0.8 ; Vslp1 = 0.5 / max(obsCR)
CV_VM2 = 0.4 ; Vint = 0.35 ; Vslp2 = 0.075 # (0.55 - Vint) / max(obsCR)
CRvec = seq(min(obsCR)*0.5,max(obsCR)*2,length.out=100)
pRR_pois = pois_RR(CRvec, BagLim, V_pois)
pRR_ln1 = lnorm1_RR(CRvec, BagLim, CV_ln1, V_ln1)
pRR_ln2 = lnorm2_RR(CRvec, BagLim, CV_ln2, V1_ln2, V2_ln2)
pRR_VM1 = lnormVM1_RR(CRvec, BagLim, CV_VM1, Vslp1)
pRR_VM2 = lnormVM2_RR(CRvec, BagLim, CV_VM2, Vint, Vslp2)
xlim=c(1.3,3.1) # range(muCR$x)+c(-0.1,0.1)
par(mai=c(1,1,0,0))
plot(obsCR,obsRR,pch=19,col="black",xlim=xlim,ylim=range(obsRR),xlab="Observed Mean Catch Rate",ylab="Observed Proportion Released")
grid()
abline(v=3,lty=2,col="#99999980",lwd=3)
text(obsCR+0.08,obsRR,YS,cex=0.6)
lines(CRvec,pRR_ln1,pch=19,col="red",lwd=2)
legend('topleft',legend=c(paste0("Observed (BL = ",BagLim,")"),
paste0("L2P1 (Vol. RR = ",V_ln1,"  LNCV = ",CV_ln1),
paste0("L3P1 (Vol. RR 1fish = ",V1_ln2,"  Vol. RR BL = ",V2_ln2,"  LNCV = ",CV_ln2),
paste0("L2P2 (Vol. RR slp = ",Vslp1," LNCV = ",CV_VM1),
paste0("L3P2 (Vol. RR slp = ",Vslp2,"  Vol. RR int = ",Vint,"  LNCV = ",CV_VM2),
paste0("Poisson (Vol. RR = ",V_pois,")")
),
cex=0.75,text.col=c("black",'red',"blue","green","orange","grey"),bty="n")
lines(CRvec,pRR_ln2,pch=19,col="blue",lwd=2)
lines(CRvec,pRR_VM1,pch=19,col="green",lwd=2)
lines(CRvec,pRR_VM2,pch=19,col="orange",lwd=2)
lines(CRvec,pRR_pois,pch=19,col="grey",lwd=2)
dev.off()
copyall(thisdir=paste0(frompath,"/Figures/Data/"),todir= paste0(topath,"/Figures/"))
jpeg("./Figures/Data/RRfits.jpeg",width=6,height=6,res=600,units='in')
BagLim = 3
V_pois = 0.5
V_ln1 = 0.5 ; CV_ln1 = 0.4
V1_ln2 = 0.2 ; V2_ln2 = 0.5 ; CV_ln2 = 0.4
CV_VM1 = 0.8 ; Vslp1 = 0.5 / max(obsCR)
CV_VM2 = 0.4 ; Vint = 0.35 ; Vslp2 = 0.075 # (0.55 - Vint) / max(obsCR)
CRvec = seq(min(obsCR)*0.5,max(obsCR)*2,length.out=100)
pRR_pois = pois_RR(CRvec, BagLim, V_pois)
pRR_ln1 = lnorm1_RR(CRvec, BagLim, CV_ln1, V_ln1)
pRR_ln2 = lnorm2_RR(CRvec, BagLim, CV_ln2, V1_ln2, V2_ln2)
pRR_VM1 = lnormVM1_RR(CRvec, BagLim, CV_VM1, Vslp1)
pRR_VM2 = lnormVM2_RR(CRvec, BagLim, CV_VM2, Vint, Vslp2)
xlim=c(1.3,3.1) # range(muCR$x)+c(-0.1,0.1)
par(mai=c(1,1,0,0))
plot(obsCR,obsRR,pch=19,col="black",xlim=xlim,ylim=range(obsRR),xlab="Observed Mean Catch Rate",ylab="Observed Proportion Released")
grid()
abline(v=3,lty=2,col="#99999980",lwd=3)
text(obsCR+0.08,obsRR,YS,cex=0.6)
lines(CRvec,pRR_ln1,pch=19,col="red",lwd=2)
legend('topleft',legend=c(paste0("Observed (BL = ",BagLim,")"),
paste0("L2P1 (Vol. RR = ",V_ln1,"  LNCV = ",CV_ln1),
paste0("L3P1 (Vol. RR 1fish = ",V1_ln2,"  Vol. RR BL = ",V2_ln2,"  LNCV = ",CV_ln2),
paste0("L2P2 (Vol. RR slp = ",Vslp1," LNCV = ",CV_VM1),
paste0("L3P2 (Vol. RR slp = ",Vslp2,"  Vol. RR int = ",Vint,"  LNCV = ",CV_VM2),
paste0("Poisson (Vol. RR = ",V_pois,")")
),
cex=0.75,text.col=c("black",'red',"blue","green","orange","grey"),bty="n")
lines(CRvec,pRR_ln2,pch=19,col="blue",lwd=2)
lines(CRvec,pRR_VM1,pch=19,col="green",lwd=2)
lines(CRvec,pRR_VM2,pch=19,col="orange",lwd=2)
lines(CRvec,pRR_pois,pch=19,col="grey",lwd=2)
dev.off()
copyall(thisdir=paste0(frompath,"/Figures/Data/"),todir= paste0(topath,"/Figures/"))
BagLim = 3
V_pois = 0.5
V_ln1 = 0.5 ; CV_ln1 = 0.4
V1_ln2 = 0.2 ; V2_ln2 = 0.5 ; CV_ln2 = 0.4
CV_VM1 = 0.8 ; Vslp1 = 0.5 / max(obsCR)
CV_VM2 = 0.4 ; Vint = 0.35 ; Vslp2 = 0.075 # (0.55 - Vint) / max(obsCR)
CRvec = seq(min(obsCR)*0.5,max(obsCR)*2,length.out=100)
pRR_pois = pois_RR(CRvec, BagLim, V_pois)
pRR_ln1 = lnorm1_RR(CRvec, BagLim, CV_ln1, V_ln1)
pRR_ln2 = lnorm2_RR(CRvec, BagLim, CV_ln2, V1_ln2, V2_ln2)
pRR_VM1 = lnormVM1_RR(CRvec, BagLim, CV_VM1, Vslp1)
pRR_VM2 = lnormVM2_RR(CRvec, BagLim, CV_VM2, Vint, Vslp2)
xlim=c(1.3,3.1) # range(muCR$x)+c(-0.1,0.1)
par(mai=c(1,1,0,0))
plot(obsCR,obsRR,pch=19,col="black",xlim=xlim,ylim=range(obsRR),xlab="Observed Mean Catch Rate",ylab="Observed Proportion Released")
grid()
abline(v=3,lty=2,col="#99999980",lwd=3)
text(obsCR+0.08,obsRR,YS,cex=0.6)
lines(CRvec,pRR_ln1,pch=19,col="red",lwd=2)
legend('topleft',legend=c(paste0("Observed (BL = ",BagLim,")"),
paste0("L2P1 (Vol. RR = ",V_ln1,"  LNCV = ",CV_ln1),
paste0("L3P1 (Vol. RR 1fish = ",V1_ln2,"  Vol. RR BL = ",V2_ln2,"  LNCV = ",CV_ln2),
paste0("L2P2 (Vol. RR slp = ",Vslp1," LNCV = ",CV_VM1),
paste0("L3P2 (Vol. RR slp = ",Vslp2,"  Vol. RR int = ",Vint,"  LNCV = ",CV_VM2),
paste0("Poisson (Vol. RR = ",V_pois,")")
),
cex=0.75,text.col=c("black",'red',"blue","green","orange","grey"),bty="n")
lines(CRvec,pRR_ln2,pch=19,col="blue",lwd=2)
lines(CRvec,pRR_VM1,pch=19,col="green",lwd=2)
lines(CRvec,pRR_VM2,pch=19,col="orange",lwd=2)
lines(CRvec,pRR_pois,pch=19,col="grey",lwd=2)
jpeg("./Figures/Data/RRfits.jpeg",width=6,height=6,res=600,units='in')
BagLim = 3
V_pois = 0.5
V_ln1 = 0.5 ; CV_ln1 = 0.4
V1_ln2 = 0.2 ; V2_ln2 = 0.5 ; CV_ln2 = 0.4
CV_VM1 = 0.8 ; Vslp1 = 0.5 / max(obsCR)
CV_VM2 = 0.4 ; Vint = 0.35 ; Vslp2 = 0.075 # (0.55 - Vint) / max(obsCR)
CRvec = seq(min(obsCR)*0.5,max(obsCR)*2,length.out=100)
pRR_pois = pois_RR(CRvec, BagLim, V_pois)
pRR_ln1 = lnorm1_RR(CRvec, BagLim, CV_ln1, V_ln1)
pRR_ln2 = lnorm2_RR(CRvec, BagLim, CV_ln2, V1_ln2, V2_ln2)
pRR_VM1 = lnormVM1_RR(CRvec, BagLim, CV_VM1, Vslp1)
pRR_VM2 = lnormVM2_RR(CRvec, BagLim, CV_VM2, Vint, Vslp2)
xlim=c(1.3,3.1) # range(muCR$x)+c(-0.1,0.1)
par(mai=c(1,1,0,0))
plot(obsCR,obsRR,pch=19,col="black",xlim=xlim,ylim=range(obsRR),xlab="Observed Mean Catch Rate",ylab="Observed Proportion Released")
grid()
abline(v=3,lty=2,col="#99999980",lwd=3)
text(obsCR+0.08,obsRR,YS,cex=0.6)
lines(CRvec,pRR_ln1,pch=19,col="red",lwd=2)
legend('topleft',legend=c(paste0("Observed (BL = ",BagLim,")"),
paste0("L2P1 (Vol. RR = ",V_ln1,"  LNCV = ",CV_ln1),
paste0("L3P1 (Vol. RR 1fish = ",V1_ln2,"  Vol. RR BL = ",V2_ln2,"  LNCV = ",CV_ln2),
paste0("L2P2 (Vol. RR slp = ",round(Vslp1,3)," LNCV = ",CV_VM1),
paste0("L3P2 (Vol. RR slp = ",Vslp2,"  Vol. RR int = ",Vint,"  LNCV = ",CV_VM2),
paste0("Poisson (Vol. RR = ",V_pois,")")
),
cex=0.75,text.col=c("black",'red',"blue","green","orange","grey"),bty="n")
lines(CRvec,pRR_ln2,pch=19,col="blue",lwd=2)
lines(CRvec,pRR_VM1,pch=19,col="green",lwd=2)
lines(CRvec,pRR_VM2,pch=19,col="orange",lwd=2)
lines(CRvec,pRR_pois,pch=19,col="grey",lwd=2)
dev.off()
copyall(thisdir=paste0(frompath,"/Figures/Data/"),todir= paste0(topath,"/Figures/"))
file.copy(paste0(frompathG,"/Status Assumptions To Do.xlsx"),paste0(topath,"/Project_Info/Status Assumptions To Do.xlsx"),overwrite=T)
49/40
9/40
file.copy(paste0(frompathG,"/Status Assumptions To Do.xlsx"),paste0(topath,"/Project_Info/Status Assumptions To Do.xlsx"),overwrite=T)
githubdir = "C:/Github/"
githubdir = "C:/Users/tcarruth/Documents/Github/"
frompath = paste0(githubdir,"CDFW_Bag_Limits")
frompathG = "G:/Shared drives/BM shared/1. Projects/CDFW_halibut_bag_limits"
topath = paste0(githubdir,"CaliBL/docs")
copyall = function(thisdir, todir){
fromfiles = list.files(thisdir,include.dirs = F)
for(j in 1:length(fromfiles))  file.copy(paste0(thisdir,fromfiles[j]), paste0(todir,fromfiles[j]),overwrite=T)
}
file.copy(paste0(frompathG,"/Status Assumptions To Do.xlsx"),paste0(topath,"/Project_Info/Status Assumptions To Do.xlsx"),overwrite=T)
